__max_num_config_instances: &max_num_config_instances 16

module_name: uavcan

parameters:
    - group: UAVCAN Outputs
      definitions:

        UAVCAN_SV_MAV:
            description:
                short: UAVCAN enable servo mavlink stream
                long: |
                    UAVCAN parameter for enabling/disabling
                    mavlink stream of servo states.
            type: enum
            values:
                0: DISABLE
                1: ENABLE
            reboot_required: true
            default: 0

        UAVCAN_SV_MAVR:
            description:
                short: UAVCAN servo mavlink stream rate
                long: |
                    SIMULINK parameter for setting the streaming rate
                    of actuator status message for servo output.

            type: float
            decimal: 1
            unit: Hz
            min: 0
            max: 100
            reboot_required: true
            default: 1

        UAVCAN_SV_CBRK:
            description:
                short: This is UAVCAN safety circuit breaker for servo output
                long: |
                    Default is 0. If 0, all safety checks and failsafes are enabled.
                    You can use this to ignore these checks for ESCs that are sent
                    over servo channels. To disable safety for servos, just set FAIL and
                    DISARM values to -1.
            type: enum
            values:
                0: DEFAULT
                1: NO_SAFETY_CHECKS
            default: 0

        UAVCAN_SV_MIN:
            description:
                short: UAVCAN global minimum value
                long: |
                    Set to 1000 for industry default or 900 to increase servo travel.

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: 800
            max: 1400
            default: 1000

        UAVCAN_SV_MAX:
            description:
                short: UAVCAN servo output global maximum value
                long: |
                    Set to 2000 for industry default or 2100 to increase servo travel.

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: 1600
            max: 2200
            default: 2000

        UAVCAN_SV_DISARM:
            description:
                short: UAVCAN servo output blobal disarmed value
                long: |
                    This is the PWM pulse the autopilot is outputting if not armed.
                    The main use of this parameter is to silence ESCs when they are disarmed.
                    If set to < 0, PWM always directly passes though without checking for state (no check if need to send DISARM VALUE).
                    THIS WON'T DISABLE OUTPUT, use EN flag for that.

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -1
            max: 2200
            default: -1

        UAVCAN_SV_FAIL:
            description:
                short: UAVCAN servo output failsafe value
                long: |
                    This is the PWM pulse the autopilot is outputting if in failsafe mode.
                    If set to < 0, PWM always directly passes though without checking for state (no check if need to send FAIL VALUE).
                    THIS WON'T DISABLE OUTPUT, use EN flag for that.

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -1
            max: 2200
            default: -1

        UAVCAN_SV_MIN${i}:
            description:
                short: UAVCAN servo output ${i} minimum value
                long: |
                    This is the minimum PWM pulse the autopilot is allowed to output.
                    When set to -1 the value for UAVCAN_SV_MIN will be used

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -1
            max: 1600
            num_instances: *max_num_config_instances
            instance_start: 1
            default: -1

        UAVCAN_SV_MAX${i}:
            description:
                short: UAVCAN servo output ${i} maximum value
                long: |
                    This is the maximum PWM pulse the autopilot is allowed to output.
                    When set to -1 the value for UAVCAN_SV_MAX will be used

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -1
            max: 2150
            num_instances: *max_num_config_instances
            instance_start: 1
            default: -1

        UAVCAN_SV_FAIL${i}:
            description:
                short: UAVCAN servo output ${i} failsafe value
                long: |
                    This is the PWM pulse the autopilot is outputting if in failsafe mode.
                    Uses global values if set to < 0

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -1
            max: 2150
            num_instances: *max_num_config_instances
            instance_start: 1
            default: -1

        UAVCAN_SV_DIS${i}:
            description:
                short: UAVCAN servo output ${i} disarmed value
                long: |
                    This is the PWM pulse the autopilot is outputting if not armed.
                    Uses global values if set to < 0

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -1
            max: 2150
            num_instances: *max_num_config_instances
            instance_start: 1
            default: -1

        UAVCAN_SV_TRIM${i}:
            description:
                short: UAVCAN servo output ${i} trim value
                long: |
                    This is an offset that is being applied to PWM value.
                    If 0, always centers at midrange.

                    This will generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: int32
            unit: us
            min: -500
            max: 500
            num_instances: *max_num_config_instances
            instance_start: 1
            default: 0

        UAVCAN_SV_REV${i}:
            description:
                short: UAVCAN servo output ${i} reverse value
                long: |
                    Enable to invert the channel.
                    Warning: Use this parameter when connected to a servo only.
                    For a brushless motor, invert manually two phases to reverse the direction.
            type: enum
            values:
                0: DEFAULT
                1: REVERSE
            min: 0
            max: 1
            num_instances: *max_num_config_instances
            instance_start: 1
            default: 0

        UAVCAN_SV_EN${i}:
            description:
                short: Enable UAVCAN output ${i}
                long: |
                    This parameter controls if a servo id ${i} is sent at all (DISABLED).

                    Also, when enabled, this parameter controls if a servo id ${i} is using servo or
                    ESC control mapping logic. If set to ESC, it will ignore all user-set DISARM and TRIM values,
                    and forces to use disarm logic for ESC, such that it always sends -1.
                    DOES NOT IGNORE MIN/MAX VALUES, SO CHECK THOSE FIRST.

                    This will STILL generate appropriate COMMAND_TYPE_UNITLESS for each
                    uavcan.equipment.actuator.ArrayCommand.command_value
                    This has to be always bounded to [-1 1] range and proper PWM signal
                    is generated on the receving side (CAN->PWM board). Check settings
                    of the receving end to make sure [-1 1] mapps to correct range.
                    By default, it is assumed to have [1000 2000] range.
            type: enum
            values:
                0: DISABLE_OUTPUT
                1: ENABLE_SERVO
                2: ENABLE_ESC
            min: 0
            max: 2
            num_instances: *max_num_config_instances
            instance_start: 1
            default: 0

        UAVCAN_SV_ID${i}:
            description:
                short: Mark UAVCAN output ${i} servo id
                long: |
                    This parameter sets the
                    uavcan.equipment.actuator.ArrayCommand.actuator_id
                    field for servo output ${i}. If you mess this up, I
                    disable servo output alltogther (check EN flag to re-enable).

            type: int32
            num_instances: *max_num_config_instances
            min: 0
            max: 256
            instance_start: 1
            default: ${i}
